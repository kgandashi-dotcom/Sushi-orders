<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>סושי אונליין</title>
<style>
  :root{
    --accent:#7a2a2a;
    --accent-dark:#5e1b1b;
    --muted:#f0f0f0;
    --danger:#d9534f;
    --bg:#fff;
  }
  body{
    margin:0;
    font-family: Arial, Helvetica, sans-serif;
    background: linear-gradient(180deg,#f6f5f4, #efecec);
    color:#222;
  }
  header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:10px 16px;
    background:#fff;
    flex-wrap:wrap;
  }
  .logo-container{
    width:100%;
    display:flex;
    justify-content:center;
    margin-bottom:8px;
  }
  .logo{
    width:120px;
    height:auto;
  }
  .user-actions{
    display:flex;
    gap:8px;
  }
  .btn{
    padding:6px 12px;
    border-radius:8px;
    border:none;
    cursor:pointer;
    font-weight:700;
  }
  .btn.primary{ background:var(--accent); color:#fff; }
  .btn.secondary{ background:#fff; color:var(--accent); border:1px solid #ddd; }
  nav.menu-tabs{
    display:flex;
    gap:8px;
    justify-content:center;
    flex-wrap:wrap;
    width:100%;
    margin-bottom:12px;
  }
  .tab{
    padding:8px 12px;
    border-radius:8px;
    background:#fff;
    border:1px solid #eee;
    cursor:pointer;
    font-weight:700;
  }
  .tab.active{ background:var(--accent); color:#fff; border-color:var(--accent-dark);}
  main{
    display:flex;
    gap:18px;
    flex-wrap:wrap;
    padding:0 16px 16px 16px;
  }
  #menu-area{
    flex:1;
    display:flex;
    flex-direction:column;
    gap:12px;
  }
  #side-area{
    width:360px;
    max-width:100%;
    display:flex;
    flex-direction:column;
    gap:12px;
  }
  .category-container{
    display:flex;
    flex-direction:column;
    gap:10px;
  }
  .roll-card{
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:10px;
    padding:12px;
    border-radius:10px;
    background:var(--bg);
    box-shadow:0 4px 14px rgba(0,0,0,0.05);
  }
  .roll-card img{
    width:60px;
    height:60px;
    border-radius:8px;
    object-fit:cover;
  }
  .roll-card .info{
    flex:1;
  }
  .roll-card h3{ margin:0; color:var(--accent); font-size:1rem; }
  .roll-card p{ margin:0; font-size:0.85rem; color:#444; }
  .quantity-control{ display:flex; align-items:center; gap:8px; }
  .quantity-control button{
    width:32px;
    height:32px;
    border-radius:6px;
    border:none;
    background:#f0c0c0;
    color:var(--accent);
    font-weight:700;
    font-size:1rem;
    cursor:pointer;
  }
  .quantity-control input{
    width:40px;
    text-align:center;
    border:1px solid #ddd;
    border-radius:6px;
    padding:4px;
  }
  .panel{
    background:#fff;
    padding:12px;
    border-radius:10px;
    box-shadow:0 4px 14px rgba(0,0,0,0.04);
  }
  .panel-title{ font-weight:800; color:var(--accent); margin-bottom:8px; }
  #order-summary{
    background:#fafafa;
    padding:10px;
    border-radius:8px;
    min-height:120px;
    white-space:pre-wrap;
    font-family:"Courier New", monospace;
  }
  .actions-row{ display:flex; gap:8px; margin-top:8px; flex-wrap:wrap; }
  .note{ color:#6b6b6b; font-size:0.85rem; margin-top:6px; }
  #messages{ margin-top:8px; color:var(--danger); font-weight:700; }
  @media(max-width:980px){
    main{ flex-direction:column; }
    #side-area{ width:100%; }
    nav.menu-tabs{ justify-content:flex-start; overflow-x:auto; }
  }
</style>
</head>
<body>
<header>
  <div class="user-actions">
    <button id="profile-btn" class="btn secondary">פרופיל</button>
    <button id="auth-btn" class="btn primary">התחבר</button>
  </div>
  <div class="logo-container">
    <img src="logo.png" alt="לוגו סושי" class="logo">
  </div>
  <nav class="menu-tabs" role="navigation" aria-label="תפריט קטגוריות">
    <button class="tab active" data-target="insideout-rolls">Inside-out</button>
    <button class="tab" data-target="maki-rolls">Maki</button>
    <button class="tab" data-target="onigiri-rolls">Onigiri</button>
    <button class="tab" data-target="poke-rolls">Poke</button>
    <button class="tab" data-target="oshizushi-rolls">Oshizushi</button>
  </nav>
</header>

<main>
  <section id="menu-area">
    <div id="insideout-rolls" class="category-container"></div>
    <div id="maki-rolls" class="category-container" style="display:none;"></div>
    <div id="onigiri-rolls" class="category-container" style="display:none;"></div>
    <div id="poke-rolls" class="category-container" style="display:none;"></div>
    <div id="oshizushi-rolls" class="category-container" style="display:none;"></div>
  </section>

  <aside id="side-area">
    <section class="panel">
      <div class="panel-title">רטבים</div>
      <div id="sauces-container" class="category-container"></div>
      <p class="note">כל רול מקבל 2 רטבים חינם. רוטב נוסף 3₪.</p>
    </section>
    <section class="panel">
      <div class="panel-title">כמות צ'ופסטיקס</div>
      <div class="quantity-control">
        <button id="chopsticks-minus">−</button>
        <input id="chopsticks-qty" type="number" readonly value="1">
        <button id="chopsticks-plus">+</button>
      </div>
    </section>
    <section class="panel">
      <div class="panel-title">בחר שעת איסוף</div>
      <select id="pickup-time"><option value="">בחר שעה</option></select>
      <p class="note small" id="pickup-note"></p>
    </section>
    <section class="panel">
      <div class="panel-title">הערות אישיות</div>
      <textarea id="notes" placeholder="לדוגמה: ללא גלוטן, הגעה בשער 3..."></textarea>
    </section>
    <section class="panel">
      <div class="panel-title">סיכום הזמנה</div>
      <pre id="order-summary">הזמנה ריקה — בחר רולים, רטבים ושעה להצגת הסיכום.</pre>
      <div class="actions-row">
        <button id="send-order" class="btn primary">שלח הזמנה</button>
        <button id="guest-btn" class="btn secondary">שלח כאורח</button>
      </div>
    </section>
    <div id="messages" aria-live="polite"></div>
  </aside>
</main>

<script>
const MAKE_WEBHOOK_URL='https://hook.eu2.make.com/asitqrbtyjum10ph3vf6gxhkd766us3r';
let chopsticksCount=1;
let selectedRolls={};
let selectedSauces={};

const insideOutRollsData=[
{id:"bingo",name:"רול בינגו - 50₪",description:"סלמון נא, שמנת, אבוקדו",price:50},
{id:"luna",name:"רול לונה - 50₪",description:"ספייסי סלמון אפוי על רול בטטה, אבוקדו ושיטאקי",price:50}];

const makiRollsData=[
{id:"alfi",name:"רול אלפי - 35₪",description:"מאקי סלמון",price:35}];

const onigiriData=[
{id:"rocky",name:"אוניגירי רוקי - 35₪",description:"טרטר טונה אדומה עם ספייסי מיונז ובצל ירוק",price:35}];

const pokeData=[
{id:"dog",name:"בול-דוג - 60₪",description:"אורז סושי, סלמון במרינדה, אדממה, מלפפון, אבוקדו",price:60}];

const oshizushiData=[
{id:"oshi1",name:"אושי 1 - 55₪",description:"רול אושי מיוחד",price:55}];

const saucesData=[
{id:"spicy-mayo",name:"ספייסי מיונז",price:3},
{id:"soy",name:"סויה",price:3},
{id:"teriyaki",name:"טריאקי",price:3},
{id:"ginger",name:"ג׳ינג׳ר",price:3},
{id:"wasabi",name:"וואסאבי",price:3}];

function $id(id){return document.getElementById(id);}
function showMessage(txt,isError=true){const m=$id('messages');m.textContent=txt;m.style.color=isError?'#b71c1c':'#2a7a2a';setTimeout(()=>{if(m.textContent===txt)m.textContent='';},6000);}

function createRollCard(item, containerId){
  const container=$id(containerId);
  const card=document.createElement('div');
  card.className='roll-card';
  const info=document.createElement('div'); info.className='info';
  info.innerHTML=`<h3>${item.name}</h3><p>${item.description}</p>`;
  const controls=document.createElement('div'); controls.className='quantity-control';
  const btnMinus=document.createElement('button'); btnMinus.textContent='−';
  const inputQty=document.createElement('input'); inputQty.type='number'; inputQty.value=selectedRolls[item.id]||0; inputQty.readOnly=true;
  const btnPlus=document.createElement('button'); btnPlus.textContent='+';
  btnPlus.addEventListener('click',()=>{selectedRolls[item.id]=(selectedRolls[item.id]||0)+1; inputQty.value=selectedRolls[item.id]; updateSummary();});
  btnMinus.addEventListener('click',()=>{if((selectedRolls[item.id]||0)>0){selectedRolls[item.id]--; inputQty.value=selectedRolls[item.id]; updateSummary();}});
  controls.append(btnMinus,inputQty,btnPlus);
  card.append(info,controls);
  container.appendChild(card);
}

function createSauceCard(item){
  const container=$id('sauces-container');
  const card=document.createElement('div'); card.className='roll-card';
  const info=document.createElement('div'); info.className='info';
  info.innerHTML=`<h3>${item.name}</h3><p>2 חינם לכל רול — מעבר לכך ${item.price}₪</p>`;
  const controls=document.createElement('div'); controls.className='quantity-control';
  const btnMinus=document.createElement('button'); btnMinus.textContent='−';
  const inputQty=document.createElement('input'); inputQty.type='number'; inputQty.value=selectedSauces[item.id]||0; inputQty.readOnly=true;
  const btnPlus=document.createElement('button'); btnPlus.textContent='+';
  btnPlus.addEventListener('click',()=>{selectedSauces[item.id]=(selectedSauces[item.id]||0)+1; inputQty.value=selectedSauces[item.id]; updateSummary();});
  btnMinus.addEventListener('click',()=>{if((selectedSauces[item.id]||0)>0){selectedSauces[item.id]--; inputQty.value=selectedSauces[item.id]; updateSummary();}});
  controls.append(btnMinus,inputQty,btnPlus);
  card.append(info,controls);
  container.appendChild(card);
}

function initMenu(){
  [insideOutRollsData, makiRollsData, onigiriData, pokeData, oshizushiData].forEach((arr,i)=>{
    const ids=['insideout-rolls','maki-rolls','onigiri-rolls','poke-rolls','oshizushi-rolls'];
    arr.forEach(r=>createRollCard(r,ids[i]));
  });
  saucesData.forEach(s=>createSauceCard(s));
}

function updateSummary(){
  let total=0,totalRolls=0,rollsLines=[];
  const all=[...insideOutRollsData,...makiRollsData,...onigiriData,...pokeData,...oshizushiData];
  for(const id in selectedRolls){const qty=selectedRolls[id]||0;if(qty>0){const item=all.find(x=>x.id===id); rollsLines.push(`${item.name} x${qty} — ${item.price*qty}₪`); total+=item.price*qty; totalRolls+=qty;}}
  let sauceLines=[],usedSaucesCount=0;
  for(const id in selectedSauces){const qty=selectedSauces[id]||0;if(qty>0){const s=saucesData.find(x=>x.id===id); sauceLines.push(`${s.name} x${qty}`); usedSaucesCount+=qty;}}
  const extra=Math.max(0,usedSaucesCount-(totalRolls*2)); const extraSauceCost=extra*3; total+=extraSauceCost;
  let text=`הזמנה חדשה:\n\n`; text+=rollsLines.length?rollsLines.join('\n')+'\n\n':'(לא נבחרו רולים)\n\n';
  text+='רטבים:\n'+(sauceLines.length?sauceLines.join('\n')+'\n':'(לא נבחרו רטבים)\n'); if(extra>0) text+=`\nעלות רטבים נוספים: ${extra} × 3₪ = ${extraSauceCost}₪\n`;
  text+=`\nכמות צ'ופסטיקס: ${chopsticksCount}\n`; const notes=$id('notes').value.trim(); if(notes) text+=`\nהערות: ${notes}\n`; text+=`\nסה"כ לתשלום: ${total}₪\n`;
  $id('order-summary').textContent=text;
}

document.querySelectorAll('.tab').forEach(tab=>{
  tab.addEventListener('click',()=>{
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active')); tab.classList.add('active');
    ['insideout-rolls','maki-rolls','onigiri-rolls','poke-rolls','oshizushi-rolls'].forEach(id=>{$id(id).style.display='none';});
    $id(tab.dataset.target).style.display='flex';
  });
});

$id('chopsticks-minus').addEventListener('click',()=>{if(chopsticksCount>1)chopsticksCount--; $id('chopsticks-qty').value=chopsticksCount; updateSummary();});
$id('chopsticks-plus').addEventListener('click',()=>{chopsticksCount++; $id('chopsticks-qty').value=chopsticksCount; updateSummary();});
$id('notes').addEventListener('input',updateSummary);

$id('send-order').addEventListener('click',()=>{fetch(MAKE_WEBHOOK_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({content:$id('order-summary').textContent})}).then(r=>r.ok?showMessage('נשלח בהצלחה!',false):showMessage('שגיאה בשליחה')).catch(e=>showMessage('שגיאה: '+e.message));});
$id('guest-btn').addEventListener('click',()=>{fetch(MAKE_WEBHOOK_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({content:$id('order-summary').textContent})}).then(r=>r.ok?showMessage('נשלח בהצלחה!',false):showMessage('שגיאה בשליחה')).catch(e=>showMessage('שגיאה: '+e.message));});

window.addEventListener('DOMContentLoaded',()=>{
  initMenu();
  updateSummary();
  const sel=$id('pickup-time');
  sel.innerHTML='<option value="">בחר שעה</option>';
  for(let h=11;h<=21;h++){sel.innerHTML+=`<option value="${h}:00">${h}:00</option>`;sel.innerHTML+=`<option value="${h}:30">${h}:30</option>`;}
});
</script>
</body>
</html>
