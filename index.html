<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>תפריט סושי</title>
<style>
:root{
  --accent:#7a2a2a; 
  --accent-dark:#5e1b1b; 
  --muted:#f0f0f0; 
  --danger:#d9534f; 
  --bg:#fff;
}

/* Base */
*{box-sizing:border-box}
body{ margin:0; font-family: Arial, Helvetica, sans-serif; background: linear-gradient(180deg,#f6f5f4, #efecec); color:#222; }
.container{ max-width:1200px; margin:16px auto; padding:14px; background: rgba(255,255,255,0.94); border-radius:12px; box-shadow:0 8px 26px rgba(0,0,0,0.08); }

/* Header / Logo / Tabs */
header{ display:flex; flex-direction:column; align-items:center; gap:12px; margin-bottom:12px; }
.logo{ width:120px; height:auto; border-radius:8px; margin:0 auto; }
.tabs-row{ display:flex; gap:8px; flex-wrap:wrap; justify-content:center; }
.tab{ padding:8px 12px; border-radius:8px; background:#fff; border:1px solid #eee; cursor:pointer; font-weight:700; }
.tab.active{ background:var(--accent); color:#fff; border-color:var(--accent-dark); }

/* Auth button top-left */
.auth-container{ position:absolute; top:12px; left:12px; display:flex; gap:8px; align-items:center; }
.btn{ padding:8px 12px; border-radius:8px; border:none; cursor:pointer; font-weight:700; }
.btn.primary{ background:var(--accent); color:#fff; }
.btn.secondary{ background:#fff; color:var(--accent); border:1px solid #ddd; }

/* Layout main */
main{ display:flex; flex-wrap:wrap; gap:18px; align-items:flex-start; }
#menu-area{ flex:1; display:flex; flex-direction:column; gap:12px; }
#side-area{ width:360px; min-width:280px; }

/* Category container & cards */
.category-container{ display:flex; flex-direction:column; gap:10px; padding:6px 0;}
.roll-card{ display:flex; justify-content:space-between; align-items:center; gap:10px; padding:12px; border-radius:10px; background:var(--bg); box-shadow:0 4px 14px rgba(0,0,0,0.05); }
.roll-card .info{ flex:1 1 auto; }
.roll-card h3{ margin:0; color:var(--accent); font-size:1.02rem; }
.roll-card p{ margin:0; color:#444; font-size:0.92rem; }

/* quantity controls */
.quantity-control{ display:flex; align-items:center; gap:8px; }
.quantity-control button{ width:38px; height:36px; border-radius:8px; border:none; background:#f0c0c0; color:var(--accent); font-weight:700; font-size:1.2rem; cursor:pointer; }
.quantity-control input{ width:56px; text-align:center; border:1px solid #ddd; padding:6px; border-radius:6px; }

/* panels */
.panel{ background:#fff; padding:12px; border-radius:10px; box-shadow:0 4px 14px rgba(0,0,0,0.04); margin-bottom:12px; }
.panel-title{ font-weight:800; color:var(--accent); margin-bottom:8px; }

/* summary */
#order-summary{ background:#fafafa; padding:10px; border-radius:8px; min-height:120px; white-space:pre-wrap; font-family:"Courier New", monospace; }
.actions-row{ display:flex; gap:8px; margin-top:8px; }

/* notes */
textarea#notes{ width:100%; height:80px; resize:vertical; }
.note{ color:#6b6b6b; font-size:0.9rem; margin-top:8px; }
.small{ font-size:0.85rem; color:#8a8a8a; }

/* messages */
#messages{ margin-top:8px; color:var(--danger); font-weight:700; }

/* modals */
.modal{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,0.35); z-index:40; padding:12px; }
.modal .modal-content{ background:#fff; padding:16px; border-radius:10px; width:100%; max-width:520px; box-shadow:0 10px 30px rgba(0,0,0,0.2); }
.modal .modal-content h3{ margin:0 0 8px 0; } 
.modal label{ display:block; margin:8px 0; } 
.modal input, .modal textarea{ width:100%; padding:8px; border:1px solid #ddd; border-radius:6px; }

/* responsive */
@media(max-width:980px){
  main{ flex-direction:column; }
  #side-area{ width:100%; }
  .tabs-row{ justify-content:center; flex-wrap:wrap; }
  .auth-container{ position:static; margin-bottom:12px; }
}
</style>
<!-- Supabase SDK -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.0.0/dist/supabase.min.js"></script>
<!-- Google Identity Services -->
<script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
<div class="auth-container">
  <button id="auth-btn" class="btn primary">התחבר</button>
  <button id="profile-btn" class="btn secondary">פרופיל</button>
</div>

<header>
  <img src="https://i.imgur.com/m6KeXAB.jpeg" alt="לוגו" class="logo">
  <div class="tabs-row">
    <button class="tab active" data-target="insideout-rolls">Inside-out</button>
    <button class="tab" data-target="maki-rolls">Maki</button>
    <button class="tab" data-target="onigiri-rolls">Onigiri</button>
    <button class="tab" data-target="poke-rolls">Poke</button>
    <button class="tab" data-target="oshizushi-rolls">Oshizushi</button>
  </div>
</header>

<main>
  <section id="menu-area">
    <div id="insideout-rolls" class="category-container"></div>
    <div id="maki-rolls" class="category-container" style="display:none;"></div>
    <div id="onigiri-rolls" class="category-container" style="display:none;"></div>
    <div id="poke-rolls" class="category-container" style="display:none;"></div>
    <div id="oshizushi-rolls" class="category-container" style="display:none;"></div>
  </section>

  <aside id="side-area">
    <section id="sauces-section" class="panel">
      <div class="panel-title">רטבים</div>
      <div id="sauces-container" class="category-container"></div>
      <p class="note">כל רול מקבל 2 רטבים חינם. רוטב נוסף 3₪.</p>
    </section>

    <section class="panel">
      <div class="panel-title">כמות צ'ופסטיקס</div>
      <div class="quantity-control">
        <button id="chopsticks-minus">−</button>
        <input id="chopsticks-qty" type="number" readonly value="1">
        <button id="chopsticks-plus">+</button>
      </div>
    </section>

    <section class="panel">
      <div class="panel-title">בחר שעת איסוף</div>
      <select id="pickup-time"><option value="">בחר שעה</option></select>
      <p class="note small" id="pickup-note"></p>
    </section>

    <section class="panel">
      <div class="panel-title">הערות אישיות</div>
      <textarea id="notes" placeholder="לדוגמה: ללא גלוטן, הגעה בשער 3..."></textarea>
    </section>

    <section class="panel">
      <div class="panel-title">סיכום הזמנה</div>
      <pre id="order-summary">הזמנה ריקה — בחר רולים, רטבים ושעה להצגת הסיכום.</pre>
      <div class="actions-row">
        <button id="send-order" class="btn primary">שלח הזמנה</button>
      </div>
    </section>

    <div id="messages"></div>
  </aside>
</main>

<script>
// --- DATA SETUP ---
const categories = {
  "insideout-rolls":[
    {name:"California Roll", desc:"אבוקדו, מלפפון, סלמון"},
    {name:"Spicy Tuna", desc:"טונה חריפה, מלפפון"},
    {name:"Dragon Roll", desc:"אבוקדו, קראנצ'י, שרימפס"}
  ],
  "maki-rolls":[
    {name:"Tekka Maki", desc:"טונה, אורז, נורי"},
    {name:"Kappa Maki", desc:"מלפפון, אורז, נורי"}
  ],
  "onigiri-rolls":[
    {name:"Salmon Onigiri", desc:"אורז, סלמון, נורי"},
    {name:"Tuna Mayo Onigiri", desc:"טונה, מיונז, נורי"}
  ],
  "poke-rolls":[
    {name:"Salmon Poke", desc:"סלמון, אבוקדו, סויה"},
    {name:"Tuna Poke", desc:"טונה, מנגו, סויה"}
  ],
  "oshizushi-rolls":[
    {name:"Oshizushi Salmon", desc:"סלמון בלחיצה"},
    {name:"Oshizushi Eel", desc:"אנטי-אינגל לוסוס"}
  ]
};

const sauces = [
  {name:"סויה"}, {name:"צ'ילי"}, {name:"ג'ינג'ר ואסאבי"}, {name:"ספייסי מאיו"}
];

let order = {};
let selectedSauces = [];
let loggedInUser = null;

// --- AUTH ---
const authBtn = document.getElementById('auth-btn');
const profileBtn = document.getElementById('profile-btn');

authBtn.addEventListener('click',()=>{ alert('פונקציית התחברות לגוגל'); });
profileBtn.addEventListener('click',()=>{ if(loggedInUser) alert(`שלום ${loggedInUser.name}`); });

// --- TABS ---
const tabs = document.querySelectorAll('.tab');
tabs.forEach(tab=>{
  tab.addEventListener('click',()=>{
    tabs.forEach(t=>t.classList.remove('active'));
    tab.classList.add('active');
    const target = tab.dataset.target;
    Object.keys(categories).forEach(cat=>{
      document.getElementById(cat).style.display = (cat===target)?'flex':'none';
    });
  });
});

// --- ROLLS RENDER ---
Object.keys(categories).forEach(cat=>{
  const container = document.getElementById(cat);
  categories[cat].forEach((roll,index)=>{
    const card = document.createElement('div');
    card.className = 'roll-card';
    const info = document.createElement('div'); info.className='info';
    info.innerHTML = `<h3>${roll.name}</h3><p>${roll.desc}</p>`;
    const qtyDiv = document.createElement('div');
    qtyDiv.className = 'quantity-control';
    const minus = document.createElement('button'); minus.textContent='−';
    const input = document.createElement('input'); input.type='number'; input.value=0; input.readOnly=true;
    const plus = document.createElement('button'); plus.textContent='+';
    minus.addEventListener('click',()=>{ if(input.value>0){ input.value--; updateOrder(); }});
    plus.addEventListener('click',()=>{ input.value++; updateOrder(); });
    qtyDiv.append(minus,input,plus);
    card.append(info, qtyDiv);
    container.appendChild(card);
  });
});

// --- SAUCES ---
const saucesContainer = document.getElementById('sauces-container');
sauces.forEach(s=>{
  const card = document.createElement('div'); card.className='roll-card';
  card.innerHTML = `<span>${s.name}</span>`;
  const checkbox = document.createElement('input'); checkbox.type='checkbox';
  checkbox.addEventListener('change',()=>{ updateOrder(); });
  card.appendChild(checkbox);
  saucesContainer.appendChild(card);
});

// --- CHOPSTICKS ---
const chopsticksInput = document.getElementById('chopsticks-qty');
document.getElementById('chopsticks-plus').addEventListener('click',()=>{ chopsticksInput.value++; updateOrder(); });
document.getElementById('chopsticks-minus').addEventListener('click',()=>{ if(chopsticksInput.value>1){ chopsticksInput.value--; updateOrder(); }});

// --- PICKUP TIME ---
const pickupSelect = document.getElementById('pickup-time');
for(let h=19; h<=22; h++){
  const maxMin = (h===22)?30:59;
  for(let m=0; m<=maxMin; m+=30){
    const val = `${h}:${m.toString().padStart(2,'0')}`;
    const opt = document.createElement('option'); opt.value=val; opt.textContent=val;
    pickupSelect.appendChild(opt);
  }
}

// --- ORDER UPDATE ---
const orderSummary = document.getElementById('order-summary');
const notes = document.getElementById('notes');
function updateOrder(){
  let summary = '';
  Object.keys(categories).forEach(cat=>{
    categories[cat].forEach((roll,index)=>{
      const input = document.querySelector(`#${cat} .roll-card:nth-child(${index+1}) input`);
      if(Number(input.value)>0){ summary+=`${roll.name} × ${input.value}\n`; }
    });
  });
  const selectedSaucesArr = Array.from(document.querySelectorAll('#sauces-container input:checked')).map((c,i)=>sauces[i].name);
  if(selectedSaucesArr.length) summary+=`\nרטבים: ${selectedSaucesArr.join(', ')}\n(2 חינם)\n`;
  summary+=`\nצ׳ופסטיקס: ${chopsticksInput.value}\n`;
  summary+=`שעת איסוף: ${pickupSelect.value || 'לא נבחרה'}\n`;
  summary+=`הערות: ${notes.value || '-'}`;
  orderSummary.textContent = summary;
}

// --- SEND ORDER ---
document.getElementById('send-order').addEventListener('click',()=>{
  // check login
  if(!loggedInUser){ alert('עליך להתחבר כדי לשלוח הזמנה'); return; }
  // check rolls selected
  let anyRollSelected=false;
  Object.keys(categories).forEach(cat=>categories[cat].forEach((roll,index)=>{
    const val = Number(document.querySelector(`#${cat} .roll-card:nth-child(${index+1}) input`).value);
    if(val>0) anyRollSelected=true;
  }));
  if(!anyRollSelected){ alert('בחר לפחות רול אחד'); return; }
  if(!pickupSelect.value){ alert('בחר שעת איסוף'); return; }
  alert('ההזמנה נשלחה בהצלחה!');
});
</script>
</body>
</html>
